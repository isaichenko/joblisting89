<!-- Titlebar
================================================== -->
<div id="titlebar">
  <div class="container">
    <div class="ten columns">
      <span>We have <%= Company.all.count %> companies:</span>
      <h2>All Companies List</h2>
    </div>

    <div class="six columns">
      <%= link_to 'Post a Job, Itâ€™s Free!', new_job_path, class: 'button' %>
    </div>

  </div>
</div>

<!-- Content
================================================== -->
<div class="container">
  <!-- Recent Jobs -->
  <div class="eleven columns">
  <div class="padding-right">

    <div class="listings-container">

      <!-- Listing -->

        <% if params[:q].present? %><h6>Results for: <i><%= params[:q] %></i></h6><% end %>
        <div class="info-cards">
          <% if @all_companies.size > 0 %>
            <%= render partial: 'all_company', collection: @all_companies %>
          <% else %>
            No results
          <% end %>
        </div>
        <%= paginate @all_companies %>

    </div>


    <div class="clearfix"></div>

    <div class="pagination-container">
      <nav class="pagination">
        <ul>
          <li><a href="#" class="current-page">1</a></li>
          <li><a href="#">2</a></li>
          <li><a href="#">3</a></li>
          <li class="blank">...</li>
          <li><a href="#">22</a></li>
        </ul>
      </nav>

      <nav class="pagination-next-prev">
        <ul>
          <li><a href="#" class="prev">Previous</a></li>
          <li><a href="#" class="next">Next</a></li>
        </ul>
      </nav>
    </div>

  </div>
  </div>

 <!-- Widgets -->
  <div class="five columns">

    <!-- Sort by -->

      <!-- Select -->
      <%= form_with method: :get, local: true, url: allcompanies_path, id: "filter-auto" do |f| %>
      <h4>Sort by</h4>
      <%= f.select :sort_by, options_for_select(Company::SORT_PARAMS.keys.collect{ |t| [t.humanize, t] }, params[:sort_by]), {}, class: "chosen-select-no-single" %>


    <!-- Filter -->
    <div class="widget">
      <h4>Filter:
        <% if @filter_active %>
          <span style="font-size: 15px;">
            <%= link_to "(clear)", allcompanies_path %>
          </span>
        <% end %>
      </h4>
    </div>

    <!-- Job title -->
    <div class="widget">
      <h4>
        <%= render "pages/partials/filter", arr: @all_companies.aggs['title'], form: f, title: "Job title", name_inp: :title %>
      </h4>
    </div>

    <!-- Industry -->
    <div class="widget">
      <h4>
        <%= render "pages/partials/filter", arr: @all_companies.aggs['industry'], form: f, title: "Industry", name_inp: :industry %>
      </h4>
    </div>

    <!-- City -->
    <div class="widget">
      <h4>
        <%= render "pages/partials/filter", arr: @all_companies.aggs['city'], form: f, title: "City", name_inp: :city %>
      </h4>
    </div>

  <%= f.hidden_field :q, value: params[:q] %>
      <!--<%= f.submit "Update", class: "btn btn-primary", name: nil %>-->
    <% end %>

  </div>
  <!-- Widgets / End -->
</div>

<script>
$(document).on("turbolinks:load", function(){
  $('.star-rating').raty({
      path: '/assets/',
      readOnly: true,
      score: function() {
            return $(this).attr('data-score');
    }
  });
})
</script>
